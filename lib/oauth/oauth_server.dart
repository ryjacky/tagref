import 'dart:convert';
import 'dart:developer';
import 'dart:io';
import 'package:http/http.dart' as http;

import 'package:tagref/assets/constant.dart';
import 'package:url_launcher/url_launcher.dart';

import 'oauth_credentials.dart';

enum OAuthType {twitter}

class OAuthServer {
  static late HttpServer server;

  /// Force close the server connection
  static void forceClose(){
    server.close();
  }

  /// Starts and listen on oauth server, launch user consent when the oauth
  /// server is ready.
  ///
  /// Returns OAuthCredentials object containing the access token,
  /// OAuthCredentials.code and OAuthCredentials.state can be null when
  /// the authorization fails. null object will be returned when oauth server
  /// fails.
  static Future<OAuthCredentials?> listen(Uri userConsent, OAuthType type) async {
    server = await HttpServer.bind(InternetAddress.anyIPv4, 56738);

    OAuthCredentials? cred;

    launchUrl(userConsent);

    // Listen to oauth server for user consent response
    await server.forEach((HttpRequest request) async {
      request.response.headers.contentType = ContentType.html;
      request.response.write(
          """<!DOCTYPE html><html><head></head><body style="background:linear-gradient(23deg,rgba(2,0,36,1) 0,rgba(75,9,121,1) 35%,rgba(0,212,255,1) 100%)"><div class="wrapper"><div class="confetti-149"></div><div class="confetti-148"></div><div class="confetti-147"></div><div class="confetti-146"></div><div class="confetti-145"></div><div class="confetti-144"></div><div class="confetti-143"></div><div class="confetti-142"></div><div class="confetti-141"></div><div class="confetti-140"></div><div class="confetti-139"></div><div class="confetti-138"></div><div class="confetti-137"></div><div class="confetti-136"></div><div class="confetti-135"></div><div class="confetti-134"></div><div class="confetti-133"></div><div class="confetti-132"></div><div class="confetti-131"></div><div class="confetti-130"></div><div class="confetti-129"></div><div class="confetti-128"></div><div class="confetti-127"></div><div class="confetti-126"></div><div class="confetti-125"></div><div class="confetti-124"></div><div class="confetti-123"></div><div class="confetti-122"></div><div class="confetti-121"></div><div class="confetti-120"></div><div class="confetti-119"></div><div class="confetti-118"></div><div class="confetti-117"></div><div class="confetti-116"></div><div class="confetti-115"></div><div class="confetti-114"></div><div class="confetti-113"></div><div class="confetti-112"></div><div class="confetti-111"></div><div class="confetti-110"></div><div class="confetti-109"></div><div class="confetti-108"></div><div class="confetti-107"></div><div class="confetti-106"></div><div class="confetti-105"></div><div class="confetti-104"></div><div class="confetti-103"></div><div class="confetti-102"></div><div class="confetti-101"></div><div class="confetti-100"></div><div class="confetti-99"></div><div class="confetti-98"></div><div class="confetti-97"></div><div class="confetti-96"></div><div class="confetti-95"></div><div class="confetti-94"></div><div class="confetti-93"></div><div class="confetti-92"></div><div class="confetti-91"></div><div class="confetti-90"></div><div class="confetti-89"></div><div class="confetti-88"></div><div class="confetti-87"></div><div class="confetti-86"></div><div class="confetti-85"></div><div class="confetti-84"></div><div class="confetti-83"></div><div class="confetti-82"></div><div class="confetti-81"></div><div class="confetti-80"></div><div class="confetti-79"></div><div class="confetti-78"></div><div class="confetti-77"></div><div class="confetti-76"></div><div class="confetti-75"></div><div class="confetti-74"></div><div class="confetti-73"></div><div class="confetti-72"></div><div class="confetti-71"></div><div class="confetti-70"></div><div class="confetti-69"></div><div class="confetti-68"></div><div class="confetti-67"></div><div class="confetti-66"></div><div class="confetti-65"></div><div class="confetti-64"></div><div class="confetti-63"></div><div class="confetti-62"></div><div class="confetti-61"></div><div class="confetti-60"></div><div class="confetti-59"></div><div class="confetti-58"></div><div class="confetti-57"></div><div class="confetti-56"></div><div class="confetti-55"></div><div class="confetti-54"></div><div class="confetti-53"></div><div class="confetti-52"></div><div class="confetti-51"></div><div class="confetti-50"></div><div class="confetti-49"></div><div class="confetti-48"></div><div class="confetti-47"></div><div class="confetti-46"></div><div class="confetti-45"></div><div class="confetti-44"></div><div class="confetti-43"></div><div class="confetti-42"></div><div class="confetti-41"></div><div class="confetti-40"></div><div class="confetti-39"></div><div class="confetti-38"></div><div class="confetti-37"></div><div class="confetti-36"></div><div class="confetti-35"></div><div class="confetti-34"></div><div class="confetti-33"></div><div class="confetti-32"></div><div class="confetti-31"></div><div class="confetti-30"></div><div class="confetti-29"></div><div class="confetti-28"></div><div class="confetti-27"></div><div class="confetti-26"></div><div class="confetti-25"></div><div class="confetti-24"></div><div class="confetti-23"></div><div class="confetti-22"></div><div class="confetti-21"></div><div class="confetti-20"></div><div class="confetti-19"></div><div class="confetti-18"></div><div class="confetti-17"></div><div class="confetti-16"></div><div class="confetti-15"></div><div class="confetti-14"></div><div class="confetti-13"></div><div class="confetti-12"></div><div class="confetti-11"></div><div class="confetti-10"></div><div class="confetti-9"></div><div class="confetti-8"></div><div class="confetti-7"></div><div class="confetti-6"></div><div class="confetti-5"></div><div class="confetti-4"></div><div class="confetti-3"></div><div class="confetti-2"></div><div class="confetti-1"></div><div class="confetti-0"></div></div><style>body{margin:0;overflow:hidden}.wrapper{position:relative;min-height:100vh}[class|=confetti]{position:absolute}.confetti-0{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:79%;opacity:.6315895546;transform:rotate(282.5151760723deg);-webkit-animation:drop-0 4.7750281315s .861466148s infinite;animation:drop-0 4.7750281315s .861466148s infinite}@-webkit-keyframes drop-0{100%{top:110%;left:84%}}@keyframes drop-0{100%{top:110%;left:84%}}.confetti-1{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:19%;opacity:1.0662466703;transform:rotate(112.457124659deg);-webkit-animation:drop-1 4.4196939117s .6966889607s infinite;animation:drop-1 4.4196939117s .6966889607s infinite}@-webkit-keyframes drop-1{100%{top:110%;left:24%}}@keyframes drop-1{100%{top:110%;left:24%}}.confetti-2{width:4px;height:1.6px;background-color:#263672;top:-10%;left:12%;opacity:1.2819177968;transform:rotate(259.5796316059deg);-webkit-animation:drop-2 4.8546559781s .8954692517s infinite;animation:drop-2 4.8546559781s .8954692517s infinite}@-webkit-keyframes drop-2{100%{top:110%;left:19%}}@keyframes drop-2{100%{top:110%;left:19%}}.confetti-3{width:7px;height:2.8px;background-color:#d13447;top:-10%;left:76%;opacity:1.306997149;transform:rotate(179.6694528414deg);-webkit-animation:drop-3 4.2292693313s .1759872923s infinite;animation:drop-3 4.2292693313s .1759872923s infinite}@-webkit-keyframes drop-3{100%{top:110%;left:84%}}@keyframes drop-3{100%{top:110%;left:84%}}.confetti-4{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:55%;opacity:.7067699907;transform:rotate(73.1510747569deg);-webkit-animation:drop-4 4.5217017557s .3690227195s infinite;animation:drop-4 4.5217017557s .3690227195s infinite}@-webkit-keyframes drop-4{100%{top:110%;left:69%}}@keyframes drop-4{100%{top:110%;left:69%}}.confetti-5{width:2px;height:.8px;background-color:#ffbf00;top:-10%;left:72%;opacity:.5766330639;transform:rotate(218.5528289941deg);-webkit-animation:drop-5 4.0892111799s .5640304228s infinite;animation:drop-5 4.0892111799s .5640304228s infinite}@-webkit-keyframes drop-5{100%{top:110%;left:84%}}@keyframes drop-5{100%{top:110%;left:84%}}.confetti-6{width:1px;height:.4px;background-color:#263672;top:-10%;left:95%;opacity:.9701782089;transform:rotate(357.2806396782deg);-webkit-animation:drop-6 4.4963601797s .3950954546s infinite;animation:drop-6 4.4963601797s .3950954546s infinite}@-webkit-keyframes drop-6{100%{top:110%;left:107%}}@keyframes drop-6{100%{top:110%;left:107%}}.confetti-7{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:69%;opacity:1.2507928292;transform:rotate(133.526752569deg);-webkit-animation:drop-7 4.1309107241s .7375493961s infinite;animation:drop-7 4.1309107241s .7375493961s infinite}@-webkit-keyframes drop-7{100%{top:110%;left:82%}}@keyframes drop-7{100%{top:110%;left:82%}}.confetti-8{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:83%;opacity:1.1815513288;transform:rotate(36.7876841875deg);-webkit-animation:drop-8 4.6381535637s .7994174314s infinite;animation:drop-8 4.6381535637s .7994174314s infinite}@-webkit-keyframes drop-8{100%{top:110%;left:93%}}@keyframes drop-8{100%{top:110%;left:93%}}.confetti-9{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:18%;opacity:.7448093636;transform:rotate(215.8351583084deg);-webkit-animation:drop-9 4.0713985812s .2960095112s infinite;animation:drop-9 4.0713985812s .2960095112s infinite}@-webkit-keyframes drop-9{100%{top:110%;left:20%}}@keyframes drop-9{100%{top:110%;left:20%}}.confetti-10{width:4px;height:1.6px;background-color:#263672;top:-10%;left:81%;opacity:.7049713836;transform:rotate(283.0821097647deg);-webkit-animation:drop-10 4.206101154s .1188357938s infinite;animation:drop-10 4.206101154s .1188357938s infinite}@-webkit-keyframes drop-10{100%{top:110%;left:85%}}@keyframes drop-10{100%{top:110%;left:85%}}.confetti-11{width:6px;height:2.4px;background-color:#263672;top:-10%;left:13%;opacity:.5380198285;transform:rotate(288.0521701285deg);-webkit-animation:drop-11 4.7849234406s .167968295s infinite;animation:drop-11 4.7849234406s .167968295s infinite}@-webkit-keyframes drop-11{100%{top:110%;left:24%}}@keyframes drop-11{100%{top:110%;left:24%}}.confetti-12{width:7px;height:2.8px;background-color:#263672;top:-10%;left:97%;opacity:.8402167533;transform:rotate(48.534628187deg);-webkit-animation:drop-12 4.2338840134s .9884568324s infinite;animation:drop-12 4.2338840134s .9884568324s infinite}@-webkit-keyframes drop-12{100%{top:110%;left:110%}}@keyframes drop-12{100%{top:110%;left:110%}}.confetti-13{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:75%;opacity:1.0968655086;transform:rotate(51.9067860822deg);-webkit-animation:drop-13 4.1191026728s .8305507815s infinite;animation:drop-13 4.1191026728s .8305507815s infinite}@-webkit-keyframes drop-13{100%{top:110%;left:86%}}@keyframes drop-13{100%{top:110%;left:86%}}.confetti-14{width:6px;height:2.4px;background-color:#ffbf00;top:-10%;left:49%;opacity:.8153776692;transform:rotate(220.9893326967deg);-webkit-animation:drop-14 4.481529917s .2735287698s infinite;animation:drop-14 4.481529917s .2735287698s infinite}@-webkit-keyframes drop-14{100%{top:110%;left:61%}}@keyframes drop-14{100%{top:110%;left:61%}}.confetti-15{width:1px;height:.4px;background-color:#263672;top:-10%;left:8%;opacity:.9293840979;transform:rotate(308.2125094918deg);-webkit-animation:drop-15 4.7668974933s .5935351292s infinite;animation:drop-15 4.7668974933s .5935351292s infinite}@-webkit-keyframes drop-15{100%{top:110%;left:23%}}@keyframes drop-15{100%{top:110%;left:23%}}.confetti-16{width:1px;height:.4px;background-color:#d13447;top:-10%;left:11%;opacity:.6335894662;transform:rotate(184.2272012615deg);-webkit-animation:drop-16 4.8496035898s .3264094637s infinite;animation:drop-16 4.8496035898s .3264094637s infinite}@-webkit-keyframes drop-16{100%{top:110%;left:25%}}@keyframes drop-16{100%{top:110%;left:25%}}.confetti-17{width:2px;height:.8px;background-color:#d13447;top:-10%;left:13%;opacity:.6233129557;transform:rotate(270.0418838701deg);-webkit-animation:drop-17 4.5642613545s .4599898037s infinite;animation:drop-17 4.5642613545s .4599898037s infinite}@-webkit-keyframes drop-17{100%{top:110%;left:20%}}@keyframes drop-17{100%{top:110%;left:20%}}.confetti-18{width:7px;height:2.8px;background-color:#263672;top:-10%;left:100%;opacity:1.1170596182;transform:rotate(233.4573093731deg);-webkit-animation:drop-18 4.2654258572s .5991933926s infinite;animation:drop-18 4.2654258572s .5991933926s infinite}@-webkit-keyframes drop-18{100%{top:110%;left:115%}}@keyframes drop-18{100%{top:110%;left:115%}}.confetti-19{width:2px;height:.8px;background-color:#d13447;top:-10%;left:76%;opacity:.6441875086;transform:rotate(149.9144308004deg);-webkit-animation:drop-19 4.0823741385s .2275553075s infinite;animation:drop-19 4.0823741385s .2275553075s infinite}@-webkit-keyframes drop-19{100%{top:110%;left:87%}}@keyframes drop-19{100%{top:110%;left:87%}}.confetti-20{width:3px;height:1.2px;background-color:#263672;top:-10%;left:55%;opacity:1.1210349654;transform:rotate(272.727985078deg);-webkit-animation:drop-20 4.400313881s .7359998356s infinite;animation:drop-20 4.400313881s .7359998356s infinite}@-webkit-keyframes drop-20{100%{top:110%;left:58%}}@keyframes drop-20{100%{top:110%;left:58%}}.confetti-21{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:83%;opacity:.5699744428;transform:rotate(290.5836847283deg);-webkit-animation:drop-21 4.4869911242s .5903359274s infinite;animation:drop-21 4.4869911242s .5903359274s infinite}@-webkit-keyframes drop-21{100%{top:110%;left:85%}}@keyframes drop-21{100%{top:110%;left:85%}}.confetti-22{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:22%;opacity:.848233696;transform:rotate(51.946368898deg);-webkit-animation:drop-22 4.3252334812s .9253979453s infinite;animation:drop-22 4.3252334812s .9253979453s infinite}@-webkit-keyframes drop-22{100%{top:110%;left:26%}}@keyframes drop-22{100%{top:110%;left:26%}}.confetti-23{width:2px;height:.8px;background-color:#d13447;top:-10%;left:31%;opacity:.8430138441;transform:rotate(47.6519689654deg);-webkit-animation:drop-23 4.3332234786s .2256354454s infinite;animation:drop-23 4.3332234786s .2256354454s infinite}@-webkit-keyframes drop-23{100%{top:110%;left:33%}}@keyframes drop-23{100%{top:110%;left:33%}}.confetti-24{width:3px;height:1.2px;background-color:#d13447;top:-10%;left:21%;opacity:.9941725283;transform:rotate(295.5177888691deg);-webkit-animation:drop-24 4.9733207624s .6095547336s infinite;animation:drop-24 4.9733207624s .6095547336s infinite}@-webkit-keyframes drop-24{100%{top:110%;left:24%}}@keyframes drop-24{100%{top:110%;left:24%}}.confetti-25{width:5px;height:2px;background-color:#ffbf00;top:-10%;left:94%;opacity:1.4269728295;transform:rotate(168.0530531106deg);-webkit-animation:drop-25 4.4535142103s .661958178s infinite;animation:drop-25 4.4535142103s .661958178s infinite}@-webkit-keyframes drop-25{100%{top:110%;left:100%}}@keyframes drop-25{100%{top:110%;left:100%}}.confetti-26{width:2px;height:.8px;background-color:#d13447;top:-10%;left:22%;opacity:1.4181035011;transform:rotate(66.4317482294deg);-webkit-animation:drop-26 4.2957767917s .4147070715s infinite;animation:drop-26 4.2957767917s .4147070715s infinite}@-webkit-keyframes drop-26{100%{top:110%;left:28%}}@keyframes drop-26{100%{top:110%;left:28%}}.confetti-27{width:6px;height:2.4px;background-color:#263672;top:-10%;left:48%;opacity:.6319406832;transform:rotate(134.3281413566deg);-webkit-animation:drop-27 4.9632751387s .1179005761s infinite;animation:drop-27 4.9632751387s .1179005761s infinite}@-webkit-keyframes drop-27{100%{top:110%;left:62%}}@keyframes drop-27{100%{top:110%;left:62%}}.confetti-28{width:5px;height:2px;background-color:#ffbf00;top:-10%;left:23%;opacity:1.2056713785;transform:rotate(359.5823110791deg);-webkit-animation:drop-28 4.1457658328s 29.2955477ms infinite;animation:drop-28 4.1457658328s 29.2955477ms infinite}@-webkit-keyframes drop-28{100%{top:110%;left:32%}}@keyframes drop-28{100%{top:110%;left:32%}}.confetti-29{width:2px;height:.8px;background-color:#d13447;top:-10%;left:94%;opacity:1.2765661312;transform:rotate(33.221351649deg);-webkit-animation:drop-29 4.7604080532s .486479123s infinite;animation:drop-29 4.7604080532s .486479123s infinite}@-webkit-keyframes drop-29{100%{top:110%;left:109%}}@keyframes drop-29{100%{top:110%;left:109%}}.confetti-30{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:54%;opacity:1.4447723941;transform:rotate(132.3203760053deg);-webkit-animation:drop-30 4.470955949s .3942660403s infinite;animation:drop-30 4.470955949s .3942660403s infinite}@-webkit-keyframes drop-30{100%{top:110%;left:65%}}@keyframes drop-30{100%{top:110%;left:65%}}.confetti-31{width:3px;height:1.2px;background-color:#d13447;top:-10%;left:51%;opacity:.9319373857;transform:rotate(213.6364788446deg);-webkit-animation:drop-31 4.2797859604s .287309599s infinite;animation:drop-31 4.2797859604s .287309599s infinite}@-webkit-keyframes drop-31{100%{top:110%;left:61%}}@keyframes drop-31{100%{top:110%;left:61%}}.confetti-32{width:2px;height:.8px;background-color:#ffbf00;top:-10%;left:99%;opacity:.9818950674;transform:rotate(313.5432460618deg);-webkit-animation:drop-32 4.0394975765s .5345470143s infinite;animation:drop-32 4.0394975765s .5345470143s infinite}@-webkit-keyframes drop-32{100%{top:110%;left:112%}}@keyframes drop-32{100%{top:110%;left:112%}}.confetti-33{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:48%;opacity:.9318823464;transform:rotate(13.374538294deg);-webkit-animation:drop-33 4.0330728812s 5.5049661ms infinite;animation:drop-33 4.0330728812s 5.5049661ms infinite}@-webkit-keyframes drop-33{100%{top:110%;left:52%}}@keyframes drop-33{100%{top:110%;left:52%}}.confetti-34{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:95%;opacity:.5778312352;transform:rotate(187.8826454606deg);-webkit-animation:drop-34 4.072104903s .9525913467s infinite;animation:drop-34 4.072104903s .9525913467s infinite}@-webkit-keyframes drop-34{100%{top:110%;left:96%}}@keyframes drop-34{100%{top:110%;left:96%}}.confetti-35{width:8px;height:3.2px;background-color:#263672;top:-10%;left:45%;opacity:.93978;transform:rotate(111.4280107818deg);-webkit-animation:drop-35 4.8147495907s .8898568733s infinite;animation:drop-35 4.8147495907s .8898568733s infinite}@-webkit-keyframes drop-35{100%{top:110%;left:55%}}@keyframes drop-35{100%{top:110%;left:55%}}.confetti-36{width:4px;height:1.6px;background-color:#263672;top:-10%;left:24%;opacity:.8617807103;transform:rotate(295.5990608082deg);-webkit-animation:drop-36 4.2123285201s 55.0621648ms infinite;animation:drop-36 4.2123285201s 55.0621648ms infinite}@-webkit-keyframes drop-36{100%{top:110%;left:32%}}@keyframes drop-36{100%{top:110%;left:32%}}.confetti-37{width:8px;height:3.2px;background-color:#ffbf00;top:-10%;left:29%;opacity:1.4219376227;transform:rotate(209.4926651526deg);-webkit-animation:drop-37 4.3026966106s .2382407065s infinite;animation:drop-37 4.3026966106s .2382407065s infinite}@-webkit-keyframes drop-37{100%{top:110%;left:39%}}@keyframes drop-37{100%{top:110%;left:39%}}.confetti-38{width:4px;height:1.6px;background-color:#263672;top:-10%;left:68%;opacity:1.0263467326;transform:rotate(236.6958393216deg);-webkit-animation:drop-38 4.1339103042s 52.2258912ms infinite;animation:drop-38 4.1339103042s 52.2258912ms infinite}@-webkit-keyframes drop-38{100%{top:110%;left:75%}}@keyframes drop-38{100%{top:110%;left:75%}}.confetti-39{width:1px;height:.4px;background-color:#263672;top:-10%;left:95%;opacity:.7887058907;transform:rotate(229.574956067deg);-webkit-animation:drop-39 4.0903185595s .262509342s infinite;animation:drop-39 4.0903185595s .262509342s infinite}@-webkit-keyframes drop-39{100%{top:110%;left:97%}}@keyframes drop-39{100%{top:110%;left:97%}}.confetti-40{width:4px;height:1.6px;background-color:#263672;top:-10%;left:28%;opacity:1.1182264504;transform:rotate(118.475886025deg);-webkit-animation:drop-40 4.0760742244s .1868002902s infinite;animation:drop-40 4.0760742244s .1868002902s infinite}@-webkit-keyframes drop-40{100%{top:110%;left:32%}}@keyframes drop-40{100%{top:110%;left:32%}}.confetti-41{width:7px;height:2.8px;background-color:#263672;top:-10%;left:85%;opacity:.7239304001;transform:rotate(107.9973015572deg);-webkit-animation:drop-41 4.1239058274s .6705213752s infinite;animation:drop-41 4.1239058274s .6705213752s infinite}@-webkit-keyframes drop-41{100%{top:110%;left:96%}}@keyframes drop-41{100%{top:110%;left:96%}}.confetti-42{width:7px;height:2.8px;background-color:#d13447;top:-10%;left:58%;opacity:.6622141187;transform:rotate(203.2714342751deg);-webkit-animation:drop-42 4.7394034882s .1064442652s infinite;animation:drop-42 4.7394034882s .1064442652s infinite}@-webkit-keyframes drop-42{100%{top:110%;left:64%}}@keyframes drop-42{100%{top:110%;left:64%}}.confetti-43{width:2px;height:.8px;background-color:#d13447;top:-10%;left:73%;opacity:1.3987101833;transform:rotate(273.7472498242deg);-webkit-animation:drop-43 4.2822869331s .5196880176s infinite;animation:drop-43 4.2822869331s .5196880176s infinite}@-webkit-keyframes drop-43{100%{top:110%;left:75%}}@keyframes drop-43{100%{top:110%;left:75%}}.confetti-44{width:7px;height:2.8px;background-color:#d13447;top:-10%;left:38%;opacity:.7900197361;transform:rotate(300.4095466222deg);-webkit-animation:drop-44 4.9959347701s .8483779366s infinite;animation:drop-44 4.9959347701s .8483779366s infinite}@-webkit-keyframes drop-44{100%{top:110%;left:44%}}@keyframes drop-44{100%{top:110%;left:44%}}.confetti-45{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:61%;opacity:.6384588316;transform:rotate(134.9997876556deg);-webkit-animation:drop-45 4.338644405s .404668502s infinite;animation:drop-45 4.338644405s .404668502s infinite}@-webkit-keyframes drop-45{100%{top:110%;left:73%}}@keyframes drop-45{100%{top:110%;left:73%}}.confetti-46{width:5px;height:2px;background-color:#d13447;top:-10%;left:41%;opacity:1.2830824458;transform:rotate(101.313761228deg);-webkit-animation:drop-46 4.8364803001s .2607935504s infinite;animation:drop-46 4.8364803001s .2607935504s infinite}@-webkit-keyframes drop-46{100%{top:110%;left:52%}}@keyframes drop-46{100%{top:110%;left:52%}}.confetti-47{width:5px;height:2px;background-color:#ffbf00;top:-10%;left:19%;opacity:1.42581758;transform:rotate(127.9692619851deg);-webkit-animation:drop-47 4.0971421818s .3843151488s infinite;animation:drop-47 4.0971421818s .3843151488s infinite}@-webkit-keyframes drop-47{100%{top:110%;left:25%}}@keyframes drop-47{100%{top:110%;left:25%}}.confetti-48{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:71%;opacity:1.3709710943;transform:rotate(13.5655294912deg);-webkit-animation:drop-48 4.141916269s .4580297883s infinite;animation:drop-48 4.141916269s .4580297883s infinite}@-webkit-keyframes drop-48{100%{top:110%;left:75%}}@keyframes drop-48{100%{top:110%;left:75%}}.confetti-49{width:5px;height:2px;background-color:#d13447;top:-10%;left:79%;opacity:1.1505539155;transform:rotate(190.4895488734deg);-webkit-animation:drop-49 4.0089407133s .5662072999s infinite;animation:drop-49 4.0089407133s .5662072999s infinite}@-webkit-keyframes drop-49{100%{top:110%;left:82%}}@keyframes drop-49{100%{top:110%;left:82%}}.confetti-50{width:2px;height:.8px;background-color:#ffbf00;top:-10%;left:22%;opacity:.5521610344;transform:rotate(271.0774451716deg);-webkit-animation:drop-50 4.6906124937s .946258844s infinite;animation:drop-50 4.6906124937s .946258844s infinite}@-webkit-keyframes drop-50{100%{top:110%;left:34%}}@keyframes drop-50{100%{top:110%;left:34%}}.confetti-51{width:2px;height:.8px;background-color:#d13447;top:-10%;left:87%;opacity:.5307288599;transform:rotate(295.7443895077deg);-webkit-animation:drop-51 4.3681970294s .6868803668s infinite;animation:drop-51 4.3681970294s .6868803668s infinite}@-webkit-keyframes drop-51{100%{top:110%;left:92%}}@keyframes drop-51{100%{top:110%;left:92%}}.confetti-52{width:8px;height:3.2px;background-color:#263672;top:-10%;left:22%;opacity:1.4086209467;transform:rotate(162.2167555538deg);-webkit-animation:drop-52 4.9949837203s .5962663988s infinite;animation:drop-52 4.9949837203s .5962663988s infinite}@-webkit-keyframes drop-52{100%{top:110%;left:33%}}@keyframes drop-52{100%{top:110%;left:33%}}.confetti-53{width:8px;height:3.2px;background-color:#ffbf00;top:-10%;left:50%;opacity:.8303385795;transform:rotate(267.9394832001deg);-webkit-animation:drop-53 4.8895984933s .8694539856s infinite;animation:drop-53 4.8895984933s .8694539856s infinite}@-webkit-keyframes drop-53{100%{top:110%;left:63%}}@keyframes drop-53{100%{top:110%;left:63%}}.confetti-54{width:4px;height:1.6px;background-color:#ffbf00;top:-10%;left:30%;opacity:1.2926555447;transform:rotate(302.7984598561deg);-webkit-animation:drop-54 4.5232363456s .3337448872s infinite;animation:drop-54 4.5232363456s .3337448872s infinite}@-webkit-keyframes drop-54{100%{top:110%;left:39%}}@keyframes drop-54{100%{top:110%;left:39%}}.confetti-55{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:87%;opacity:.7079145037;transform:rotate(58.4850323737deg);-webkit-animation:drop-55 4.6053786903s .5717474377s infinite;animation:drop-55 4.6053786903s .5717474377s infinite}@-webkit-keyframes drop-55{100%{top:110%;left:98%}}@keyframes drop-55{100%{top:110%;left:98%}}.confetti-56{width:2px;height:.8px;background-color:#ffbf00;top:-10%;left:79%;opacity:1.0275889194;transform:rotate(268.5063576313deg);-webkit-animation:drop-56 4.2440370357s .2730821098s infinite;animation:drop-56 4.2440370357s .2730821098s infinite}@-webkit-keyframes drop-56{100%{top:110%;left:89%}}@keyframes drop-56{100%{top:110%;left:89%}}.confetti-57{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:81%;opacity:1.4124179308;transform:rotate(337.8775301294deg);-webkit-animation:drop-57 4.9645618122s .1582920766s infinite;animation:drop-57 4.9645618122s .1582920766s infinite}@-webkit-keyframes drop-57{100%{top:110%;left:95%}}@keyframes drop-57{100%{top:110%;left:95%}}.confetti-58{width:7px;height:2.8px;background-color:#ffbf00;top:-10%;left:25%;opacity:1.0492015905;transform:rotate(83.0258336611deg);-webkit-animation:drop-58 4.8640890618s .3996689918s infinite;animation:drop-58 4.8640890618s .3996689918s infinite}@-webkit-keyframes drop-58{100%{top:110%;left:29%}}@keyframes drop-58{100%{top:110%;left:29%}}.confetti-59{width:5px;height:2px;background-color:#d13447;top:-10%;left:23%;opacity:1.1698469686;transform:rotate(202.5709068297deg);-webkit-animation:drop-59 4.0532465236s .7949990435s infinite;animation:drop-59 4.0532465236s .7949990435s infinite}@-webkit-keyframes drop-59{100%{top:110%;left:33%}}@keyframes drop-59{100%{top:110%;left:33%}}.confetti-60{width:2px;height:.8px;background-color:#263672;top:-10%;left:47%;opacity:.6327649937;transform:rotate(119.8090214306deg);-webkit-animation:drop-60 4.5949147849s .5340788689s infinite;animation:drop-60 4.5949147849s .5340788689s infinite}@-webkit-keyframes drop-60{100%{top:110%;left:60%}}@keyframes drop-60{100%{top:110%;left:60%}}.confetti-61{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:18%;opacity:.9351075364;transform:rotate(283.5664272735deg);-webkit-animation:drop-61 4.5809204813s .5207928234s infinite;animation:drop-61 4.5809204813s .5207928234s infinite}@-webkit-keyframes drop-61{100%{top:110%;left:20%}}@keyframes drop-61{100%{top:110%;left:20%}}.confetti-62{width:1px;height:.4px;background-color:#263672;top:-10%;left:8%;opacity:1.3197336181;transform:rotate(252.4999655364deg);-webkit-animation:drop-62 4.4495229802s .6449306484s infinite;animation:drop-62 4.4495229802s .6449306484s infinite}@-webkit-keyframes drop-62{100%{top:110%;left:13%}}@keyframes drop-62{100%{top:110%;left:13%}}.confetti-63{width:4px;height:1.6px;background-color:#263672;top:-10%;left:97%;opacity:.9254159534;transform:rotate(152.7111549245deg);-webkit-animation:drop-63 4.4735824435s .5915431393s infinite;animation:drop-63 4.4735824435s .5915431393s infinite}@-webkit-keyframes drop-63{100%{top:110%;left:103%}}@keyframes drop-63{100%{top:110%;left:103%}}.confetti-64{width:7px;height:2.8px;background-color:#d13447;top:-10%;left:9%;opacity:.6991905234;transform:rotate(85.0766381195deg);-webkit-animation:drop-64 4.310950548s .1527051129s infinite;animation:drop-64 4.310950548s .1527051129s infinite}@-webkit-keyframes drop-64{100%{top:110%;left:11%}}@keyframes drop-64{100%{top:110%;left:11%}}.confetti-65{width:2px;height:.8px;background-color:#d13447;top:-10%;left:15%;opacity:1.1740249268;transform:rotate(171.349636855deg);-webkit-animation:drop-65 4.0843996707s .1345386869s infinite;animation:drop-65 4.0843996707s .1345386869s infinite}@-webkit-keyframes drop-65{100%{top:110%;left:25%}}@keyframes drop-65{100%{top:110%;left:25%}}.confetti-66{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:11%;opacity:.5843952011;transform:rotate(336.4811142633deg);-webkit-animation:drop-66 4.9835987367s .6931199608s infinite;animation:drop-66 4.9835987367s .6931199608s infinite}@-webkit-keyframes drop-66{100%{top:110%;left:14%}}@keyframes drop-66{100%{top:110%;left:14%}}.confetti-67{width:8px;height:3.2px;background-color:#263672;top:-10%;left:41%;opacity:1.1582990829;transform:rotate(248.3625479924deg);-webkit-animation:drop-67 4.6114622972s .2917224647s infinite;animation:drop-67 4.6114622972s .2917224647s infinite}@-webkit-keyframes drop-67{100%{top:110%;left:53%}}@keyframes drop-67{100%{top:110%;left:53%}}.confetti-68{width:8px;height:3.2px;background-color:#ffbf00;top:-10%;left:31%;opacity:.8060128156;transform:rotate(315.5699950543deg);-webkit-animation:drop-68 4.6483990009s .1999794797s infinite;animation:drop-68 4.6483990009s .1999794797s infinite}@-webkit-keyframes drop-68{100%{top:110%;left:45%}}@keyframes drop-68{100%{top:110%;left:45%}}.confetti-69{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:91%;opacity:1.3812367205;transform:rotate(315.3275506635deg);-webkit-animation:drop-69 4.1502859778s 48.7718332ms infinite;animation:drop-69 4.1502859778s 48.7718332ms infinite}@-webkit-keyframes drop-69{100%{top:110%;left:103%}}@keyframes drop-69{100%{top:110%;left:103%}}.confetti-70{width:3px;height:1.2px;background-color:#d13447;top:-10%;left:99%;opacity:1.1506254517;transform:rotate(255.4848391246deg);-webkit-animation:drop-70 4.3476504441s .5788009732s infinite;animation:drop-70 4.3476504441s .5788009732s infinite}@-webkit-keyframes drop-70{100%{top:110%;left:100%}}@keyframes drop-70{100%{top:110%;left:100%}}.confetti-71{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:19%;opacity:.7222304584;transform:rotate(106.8701546498deg);-webkit-animation:drop-71 4.7388514049s .8083684706s infinite;animation:drop-71 4.7388514049s .8083684706s infinite}@-webkit-keyframes drop-71{100%{top:110%;left:27%}}@keyframes drop-71{100%{top:110%;left:27%}}.confetti-72{width:8px;height:3.2px;background-color:#263672;top:-10%;left:6%;opacity:.9811233496;transform:rotate(302.0720717684deg);-webkit-animation:drop-72 4.9354323459s .33101528s infinite;animation:drop-72 4.9354323459s .33101528s infinite}@-webkit-keyframes drop-72{100%{top:110%;left:14%}}@keyframes drop-72{100%{top:110%;left:14%}}.confetti-73{width:1px;height:.4px;background-color:#263672;top:-10%;left:67%;opacity:1.1566493128;transform:rotate(176.1479649739deg);-webkit-animation:drop-73 4.5718627308s .3537484061s infinite;animation:drop-73 4.5718627308s .3537484061s infinite}@-webkit-keyframes drop-73{100%{top:110%;left:73%}}@keyframes drop-73{100%{top:110%;left:73%}}.confetti-74{width:3px;height:1.2px;background-color:#263672;top:-10%;left:62%;opacity:1.4696227887;transform:rotate(73.874836951deg);-webkit-animation:drop-74 4.8962924675s .2306442163s infinite;animation:drop-74 4.8962924675s .2306442163s infinite}@-webkit-keyframes drop-74{100%{top:110%;left:66%}}@keyframes drop-74{100%{top:110%;left:66%}}.confetti-75{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:78%;opacity:.9529521439;transform:rotate(343.3907827029deg);-webkit-animation:drop-75 4.6947311415s .4564008942s infinite;animation:drop-75 4.6947311415s .4564008942s infinite}@-webkit-keyframes drop-75{100%{top:110%;left:84%}}@keyframes drop-75{100%{top:110%;left:84%}}.confetti-76{width:5px;height:2px;background-color:#d13447;top:-10%;left:88%;opacity:.8745561924;transform:rotate(221.4845425612deg);-webkit-animation:drop-76 4.0997285675s .6250568796s infinite;animation:drop-76 4.0997285675s .6250568796s infinite}@-webkit-keyframes drop-76{100%{top:110%;left:97%}}@keyframes drop-76{100%{top:110%;left:97%}}.confetti-77{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:74%;opacity:.7878334349;transform:rotate(21.2778074446deg);-webkit-animation:drop-77 4.3660364278s .2611895875s infinite;animation:drop-77 4.3660364278s .2611895875s infinite}@-webkit-keyframes drop-77{100%{top:110%;left:81%}}@keyframes drop-77{100%{top:110%;left:81%}}.confetti-78{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:16%;opacity:.693105495;transform:rotate(333.3464703221deg);-webkit-animation:drop-78 4.4835546798s .2656827954s infinite;animation:drop-78 4.4835546798s .2656827954s infinite}@-webkit-keyframes drop-78{100%{top:110%;left:30%}}@keyframes drop-78{100%{top:110%;left:30%}}.confetti-79{width:2px;height:.8px;background-color:#d13447;top:-10%;left:23%;opacity:.8783981325;transform:rotate(76.9728445023deg);-webkit-animation:drop-79 4.0426006748s .5772633178s infinite;animation:drop-79 4.0426006748s .5772633178s infinite}@-webkit-keyframes drop-79{100%{top:110%;left:33%}}@keyframes drop-79{100%{top:110%;left:33%}}.confetti-80{width:7px;height:2.8px;background-color:#d13447;top:-10%;left:80%;opacity:.771405997;transform:rotate(149.146749997deg);-webkit-animation:drop-80 4.6863940362s .9830373815s infinite;animation:drop-80 4.6863940362s .9830373815s infinite}@-webkit-keyframes drop-80{100%{top:110%;left:82%}}@keyframes drop-80{100%{top:110%;left:82%}}.confetti-81{width:1px;height:.4px;background-color:#d13447;top:-10%;left:59%;opacity:1.3421261514;transform:rotate(237.4581636298deg);-webkit-animation:drop-81 4.271295813s .3608451717s infinite;animation:drop-81 4.271295813s .3608451717s infinite}@-webkit-keyframes drop-81{100%{top:110%;left:64%}}@keyframes drop-81{100%{top:110%;left:64%}}.confetti-82{width:5px;height:2px;background-color:#263672;top:-10%;left:11%;opacity:.624502826;transform:rotate(274.605807176deg);-webkit-animation:drop-82 4.9628933864s .3802555001s infinite;animation:drop-82 4.9628933864s .3802555001s infinite}@-webkit-keyframes drop-82{100%{top:110%;left:20%}}@keyframes drop-82{100%{top:110%;left:20%}}.confetti-83{width:7px;height:2.8px;background-color:#ffbf00;top:-10%;left:37%;opacity:.5975458939;transform:rotate(34.6079787626deg);-webkit-animation:drop-83 4.1565104911s .2275062849s infinite;animation:drop-83 4.1565104911s .2275062849s infinite}@-webkit-keyframes drop-83{100%{top:110%;left:49%}}@keyframes drop-83{100%{top:110%;left:49%}}.confetti-84{width:5px;height:2px;background-color:#ffbf00;top:-10%;left:38%;opacity:1.1995784789;transform:rotate(85.2089673977deg);-webkit-animation:drop-84 4.4598244402s .2702243384s infinite;animation:drop-84 4.4598244402s .2702243384s infinite}@-webkit-keyframes drop-84{100%{top:110%;left:40%}}@keyframes drop-84{100%{top:110%;left:40%}}.confetti-85{width:4px;height:1.6px;background-color:#ffbf00;top:-10%;left:85%;opacity:.6238301173;transform:rotate(72.3741303105deg);-webkit-animation:drop-85 4.824796915s .1583562269s infinite;animation:drop-85 4.824796915s .1583562269s infinite}@-webkit-keyframes drop-85{100%{top:110%;left:95%}}@keyframes drop-85{100%{top:110%;left:95%}}.confetti-86{width:4px;height:1.6px;background-color:#ffbf00;top:-10%;left:17%;opacity:1.3109942855;transform:rotate(120.6736582348deg);-webkit-animation:drop-86 4.9848061084s .5189900608s infinite;animation:drop-86 4.9848061084s .5189900608s infinite}@-webkit-keyframes drop-86{100%{top:110%;left:26%}}@keyframes drop-86{100%{top:110%;left:26%}}.confetti-87{width:7px;height:2.8px;background-color:#ffbf00;top:-10%;left:33%;opacity:.6866564056;transform:rotate(353.1144342334deg);-webkit-animation:drop-87 4.808457506s .967407317s infinite;animation:drop-87 4.808457506s .967407317s infinite}@-webkit-keyframes drop-87{100%{top:110%;left:34%}}@keyframes drop-87{100%{top:110%;left:34%}}.confetti-88{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:78%;opacity:.9592345311;transform:rotate(165.950166225deg);-webkit-animation:drop-88 4.5370612791s .5665399351s infinite;animation:drop-88 4.5370612791s .5665399351s infinite}@-webkit-keyframes drop-88{100%{top:110%;left:79%}}@keyframes drop-88{100%{top:110%;left:79%}}.confetti-89{width:5px;height:2px;background-color:#d13447;top:-10%;left:38%;opacity:.8675347866;transform:rotate(253.4592603347deg);-webkit-animation:drop-89 4.5617392538s .2377090487s infinite;animation:drop-89 4.5617392538s .2377090487s infinite}@-webkit-keyframes drop-89{100%{top:110%;left:42%}}@keyframes drop-89{100%{top:110%;left:42%}}.confetti-90{width:5px;height:2px;background-color:#d13447;top:-10%;left:76%;opacity:1.0959471935;transform:rotate(204.1404486625deg);-webkit-animation:drop-90 4.3559149889s .5618092147s infinite;animation:drop-90 4.3559149889s .5618092147s infinite}@-webkit-keyframes drop-90{100%{top:110%;left:88%}}@keyframes drop-90{100%{top:110%;left:88%}}.confetti-91{width:8px;height:3.2px;background-color:#ffbf00;top:-10%;left:58%;opacity:.7866657134;transform:rotate(342.3341932222deg);-webkit-animation:drop-91 4.951131378s .833789448s infinite;animation:drop-91 4.951131378s .833789448s infinite}@-webkit-keyframes drop-91{100%{top:110%;left:72%}}@keyframes drop-91{100%{top:110%;left:72%}}.confetti-92{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:92%;opacity:.9088588324;transform:rotate(297.1792127941deg);-webkit-animation:drop-92 4.4431849469s .6785129381s infinite;animation:drop-92 4.4431849469s .6785129381s infinite}@-webkit-keyframes drop-92{100%{top:110%;left:94%}}@keyframes drop-92{100%{top:110%;left:94%}}.confetti-93{width:2px;height:.8px;background-color:#263672;top:-10%;left:44%;opacity:1.42627497;transform:rotate(9.1965507491deg);-webkit-animation:drop-93 4.7085479939s .7776417085s infinite;animation:drop-93 4.7085479939s .7776417085s infinite}@-webkit-keyframes drop-93{100%{top:110%;left:58%}}@keyframes drop-93{100%{top:110%;left:58%}}.confetti-94{width:2px;height:.8px;background-color:#ffbf00;top:-10%;left:98%;opacity:.7132848612;transform:rotate(239.5977018282deg);-webkit-animation:drop-94 4.515256181s .3041631451s infinite;animation:drop-94 4.515256181s .3041631451s infinite}@-webkit-keyframes drop-94{100%{top:110%;left:101%}}@keyframes drop-94{100%{top:110%;left:101%}}.confetti-95{width:4px;height:1.6px;background-color:#263672;top:-10%;left:13%;opacity:.9255862191;transform:rotate(350.3484420176deg);-webkit-animation:drop-95 4.8623717172s .8095037839s infinite;animation:drop-95 4.8623717172s .8095037839s infinite}@-webkit-keyframes drop-95{100%{top:110%;left:14%}}@keyframes drop-95{100%{top:110%;left:14%}}.confetti-96{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:54%;opacity:1.0369694872;transform:rotate(231.1037391704deg);-webkit-animation:drop-96 4.3259411446s .108139029s infinite;animation:drop-96 4.3259411446s .108139029s infinite}@-webkit-keyframes drop-96{100%{top:110%;left:60%}}@keyframes drop-96{100%{top:110%;left:60%}}.confetti-97{width:4px;height:1.6px;background-color:#ffbf00;top:-10%;left:21%;opacity:.7219222773;transform:rotate(42.8674697596deg);-webkit-animation:drop-97 4.4213601711s .7590285204s infinite;animation:drop-97 4.4213601711s .7590285204s infinite}@-webkit-keyframes drop-97{100%{top:110%;left:23%}}@keyframes drop-97{100%{top:110%;left:23%}}.confetti-98{width:5px;height:2px;background-color:#263672;top:-10%;left:13%;opacity:1.0744099561;transform:rotate(150.8850070207deg);-webkit-animation:drop-98 4.2262673991s .9113051574s infinite;animation:drop-98 4.2262673991s .9113051574s infinite}@-webkit-keyframes drop-98{100%{top:110%;left:25%}}@keyframes drop-98{100%{top:110%;left:25%}}.confetti-99{width:3px;height:1.2px;background-color:#263672;top:-10%;left:44%;opacity:1.3954660337;transform:rotate(165.3018879158deg);-webkit-animation:drop-99 4.832201871s .6920900427s infinite;animation:drop-99 4.832201871s .6920900427s infinite}@-webkit-keyframes drop-99{100%{top:110%;left:50%}}@keyframes drop-99{100%{top:110%;left:50%}}.confetti-100{width:1px;height:.4px;background-color:#d13447;top:-10%;left:97%;opacity:.7924719067;transform:rotate(48.2064688596deg);-webkit-animation:drop-100 4.4840921254s .9835429948s infinite;animation:drop-100 4.4840921254s .9835429948s infinite}@-webkit-keyframes drop-100{100%{top:110%;left:107%}}@keyframes drop-100{100%{top:110%;left:107%}}.confetti-101{width:4px;height:1.6px;background-color:#263672;top:-10%;left:95%;opacity:.654787932;transform:rotate(216.9122283045deg);-webkit-animation:drop-101 4.4370912101s .2455956689s infinite;animation:drop-101 4.4370912101s .2455956689s infinite}@-webkit-keyframes drop-101{100%{top:110%;left:99%}}@keyframes drop-101{100%{top:110%;left:99%}}.confetti-102{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:72%;opacity:1.1494354184;transform:rotate(59.7014463997deg);-webkit-animation:drop-102 4.1991692478s .6362917099s infinite;animation:drop-102 4.1991692478s .6362917099s infinite}@-webkit-keyframes drop-102{100%{top:110%;left:83%}}@keyframes drop-102{100%{top:110%;left:83%}}.confetti-103{width:6px;height:2.4px;background-color:#263672;top:-10%;left:2%;opacity:.6112939958;transform:rotate(276.6347208266deg);-webkit-animation:drop-103 4.3211792162s .3241253814s infinite;animation:drop-103 4.3211792162s .3241253814s infinite}@-webkit-keyframes drop-103{100%{top:110%;left:13%}}@keyframes drop-103{100%{top:110%;left:13%}}.confetti-104{width:7px;height:2.8px;background-color:#ffbf00;top:-10%;left:80%;opacity:.5732153009;transform:rotate(240.0748356461deg);-webkit-animation:drop-104 4.1107128432s .3549282459s infinite;animation:drop-104 4.1107128432s .3549282459s infinite}@-webkit-keyframes drop-104{100%{top:110%;left:93%}}@keyframes drop-104{100%{top:110%;left:93%}}.confetti-105{width:7px;height:2.8px;background-color:#263672;top:-10%;left:80%;opacity:1.4684717586;transform:rotate(268.4754169891deg);-webkit-animation:drop-105 4.2336727916s .5368231592s infinite;animation:drop-105 4.2336727916s .5368231592s infinite}@-webkit-keyframes drop-105{100%{top:110%;left:85%}}@keyframes drop-105{100%{top:110%;left:85%}}.confetti-106{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:30%;opacity:1.1573770632;transform:rotate(122.6644771924deg);-webkit-animation:drop-106 4.5359081581s .3509692586s infinite;animation:drop-106 4.5359081581s .3509692586s infinite}@-webkit-keyframes drop-106{100%{top:110%;left:37%}}@keyframes drop-106{100%{top:110%;left:37%}}.confetti-107{width:2px;height:.8px;background-color:#d13447;top:-10%;left:20%;opacity:1.1183560908;transform:rotate(332.168209586deg);-webkit-animation:drop-107 4.5019949614s .2653789741s infinite;animation:drop-107 4.5019949614s .2653789741s infinite}@-webkit-keyframes drop-107{100%{top:110%;left:23%}}@keyframes drop-107{100%{top:110%;left:23%}}.confetti-108{width:5px;height:2px;background-color:#263672;top:-10%;left:56%;opacity:1.4607235905;transform:rotate(36.2222783418deg);-webkit-animation:drop-108 4.5463281162s .7540194183s infinite;animation:drop-108 4.5463281162s .7540194183s infinite}@-webkit-keyframes drop-108{100%{top:110%;left:67%}}@keyframes drop-108{100%{top:110%;left:67%}}.confetti-109{width:1px;height:.4px;background-color:#263672;top:-10%;left:15%;opacity:1.4247729697;transform:rotate(140.8374894476deg);-webkit-animation:drop-109 4.9878231829s .9094162509s infinite;animation:drop-109 4.9878231829s .9094162509s infinite}@-webkit-keyframes drop-109{100%{top:110%;left:18%}}@keyframes drop-109{100%{top:110%;left:18%}}.confetti-110{width:7px;height:2.8px;background-color:#263672;top:-10%;left:24%;opacity:1.0358878656;transform:rotate(171.5939605879deg);-webkit-animation:drop-110 4.9310339826s .9023706258s infinite;animation:drop-110 4.9310339826s .9023706258s infinite}@-webkit-keyframes drop-110{100%{top:110%;left:35%}}@keyframes drop-110{100%{top:110%;left:35%}}.confetti-111{width:2px;height:.8px;background-color:#d13447;top:-10%;left:9%;opacity:.7522491543;transform:rotate(18.1309789595deg);-webkit-animation:drop-111 4.5147369875s .7553825743s infinite;animation:drop-111 4.5147369875s .7553825743s infinite}@-webkit-keyframes drop-111{100%{top:110%;left:18%}}@keyframes drop-111{100%{top:110%;left:18%}}.confetti-112{width:3px;height:1.2px;background-color:#263672;top:-10%;left:47%;opacity:1.4340474019;transform:rotate(124.0728629316deg);-webkit-animation:drop-112 4.0343829095s .259334096s infinite;animation:drop-112 4.0343829095s .259334096s infinite}@-webkit-keyframes drop-112{100%{top:110%;left:48%}}@keyframes drop-112{100%{top:110%;left:48%}}.confetti-113{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:71%;opacity:.8316381395;transform:rotate(331.7300106523deg);-webkit-animation:drop-113 4.2798521485s .7753384608s infinite;animation:drop-113 4.2798521485s .7753384608s infinite}@-webkit-keyframes drop-113{100%{top:110%;left:84%}}@keyframes drop-113{100%{top:110%;left:84%}}.confetti-114{width:3px;height:1.2px;background-color:#263672;top:-10%;left:97%;opacity:.6784247203;transform:rotate(349.2817661691deg);-webkit-animation:drop-114 4.4566561734s .5218626303s infinite;animation:drop-114 4.4566561734s .5218626303s infinite}@-webkit-keyframes drop-114{100%{top:110%;left:100%}}@keyframes drop-114{100%{top:110%;left:100%}}.confetti-115{width:1px;height:.4px;background-color:#263672;top:-10%;left:5%;opacity:1.3914393267;transform:rotate(8.7350775354deg);-webkit-animation:drop-115 4.3433888806s .7794546589s infinite;animation:drop-115 4.3433888806s .7794546589s infinite}@-webkit-keyframes drop-115{100%{top:110%;left:10%}}@keyframes drop-115{100%{top:110%;left:10%}}.confetti-116{width:5px;height:2px;background-color:#ffbf00;top:-10%;left:30%;opacity:.9195195093;transform:rotate(142.1296798083deg);-webkit-animation:drop-116 4.6688074643s .1053554811s infinite;animation:drop-116 4.6688074643s .1053554811s infinite}@-webkit-keyframes drop-116{100%{top:110%;left:41%}}@keyframes drop-116{100%{top:110%;left:41%}}.confetti-117{width:1px;height:.4px;background-color:#263672;top:-10%;left:76%;opacity:.6980757225;transform:rotate(66.0833194814deg);-webkit-animation:drop-117 4.628005354s .6619343237s infinite;animation:drop-117 4.628005354s .6619343237s infinite}@-webkit-keyframes drop-117{100%{top:110%;left:77%}}@keyframes drop-117{100%{top:110%;left:77%}}.confetti-118{width:7px;height:2.8px;background-color:#ffbf00;top:-10%;left:85%;opacity:1.1054167572;transform:rotate(128.206703293deg);-webkit-animation:drop-118 4.2241070236s .347498921s infinite;animation:drop-118 4.2241070236s .347498921s infinite}@-webkit-keyframes drop-118{100%{top:110%;left:88%}}@keyframes drop-118{100%{top:110%;left:88%}}.confetti-119{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:53%;opacity:.9804300714;transform:rotate(294.3237240134deg);-webkit-animation:drop-119 4.5384557408s .4154273508s infinite;animation:drop-119 4.5384557408s .4154273508s infinite}@-webkit-keyframes drop-119{100%{top:110%;left:56%}}@keyframes drop-119{100%{top:110%;left:56%}}.confetti-120{width:6px;height:2.4px;background-color:#263672;top:-10%;left:86%;opacity:1.2306832561;transform:rotate(68.7026797586deg);-webkit-animation:drop-120 4.4663141951s .6016914685s infinite;animation:drop-120 4.4663141951s .6016914685s infinite}@-webkit-keyframes drop-120{100%{top:110%;left:87%}}@keyframes drop-120{100%{top:110%;left:87%}}.confetti-121{width:2px;height:.8px;background-color:#ffbf00;top:-10%;left:94%;opacity:.8327026933;transform:rotate(31.5515385667deg);-webkit-animation:drop-121 4.827812739s .8176510431s infinite;animation:drop-121 4.827812739s .8176510431s infinite}@-webkit-keyframes drop-121{100%{top:110%;left:102%}}@keyframes drop-121{100%{top:110%;left:102%}}.confetti-122{width:4px;height:1.6px;background-color:#263672;top:-10%;left:25%;opacity:.7938936598;transform:rotate(136.4278354956deg);-webkit-animation:drop-122 4.0737804439s .1660786091s infinite;animation:drop-122 4.0737804439s .1660786091s infinite}@-webkit-keyframes drop-122{100%{top:110%;left:34%}}@keyframes drop-122{100%{top:110%;left:34%}}.confetti-123{width:7px;height:2.8px;background-color:#d13447;top:-10%;left:5%;opacity:1.3677938481;transform:rotate(160.9569858715deg);-webkit-animation:drop-123 4.1477524682s .3907615187s infinite;animation:drop-123 4.1477524682s .3907615187s infinite}@-webkit-keyframes drop-123{100%{top:110%;left:7%}}@keyframes drop-123{100%{top:110%;left:7%}}.confetti-124{width:8px;height:3.2px;background-color:#263672;top:-10%;left:15%;opacity:.5728167755;transform:rotate(275.8909668074deg);-webkit-animation:drop-124 4.0669318175s .7494762441s infinite;animation:drop-124 4.0669318175s .7494762441s infinite}@-webkit-keyframes drop-124{100%{top:110%;left:28%}}@keyframes drop-124{100%{top:110%;left:28%}}.confetti-125{width:6px;height:2.4px;background-color:#263672;top:-10%;left:86%;opacity:1.1958342811;transform:rotate(1.4448874026deg);-webkit-animation:drop-125 4.2803113409s .7890488576s infinite;animation:drop-125 4.2803113409s .7890488576s infinite}@-webkit-keyframes drop-125{100%{top:110%;left:90%}}@keyframes drop-125{100%{top:110%;left:90%}}.confetti-126{width:8px;height:3.2px;background-color:#263672;top:-10%;left:48%;opacity:.8776662578;transform:rotate(106.7414391991deg);-webkit-animation:drop-126 4.0365052382s .1053641254s infinite;animation:drop-126 4.0365052382s .1053641254s infinite}@-webkit-keyframes drop-126{100%{top:110%;left:56%}}@keyframes drop-126{100%{top:110%;left:56%}}.confetti-127{width:3px;height:1.2px;background-color:#ffbf00;top:-10%;left:24%;opacity:.7878812102;transform:rotate(337.4859245359deg);-webkit-animation:drop-127 4.8218079154s .6661309707s infinite;animation:drop-127 4.8218079154s .6661309707s infinite}@-webkit-keyframes drop-127{100%{top:110%;left:32%}}@keyframes drop-127{100%{top:110%;left:32%}}.confetti-128{width:8px;height:3.2px;background-color:#263672;top:-10%;left:23%;opacity:.7358997086;transform:rotate(53.5956341691deg);-webkit-animation:drop-128 4.0458417021s .6440499468s infinite;animation:drop-128 4.0458417021s .6440499468s infinite}@-webkit-keyframes drop-128{100%{top:110%;left:26%}}@keyframes drop-128{100%{top:110%;left:26%}}.confetti-129{width:5px;height:2px;background-color:#ffbf00;top:-10%;left:36%;opacity:1.1798628622;transform:rotate(178.6252640901deg);-webkit-animation:drop-129 4.6055025207s .2313743677s infinite;animation:drop-129 4.6055025207s .2313743677s infinite}@-webkit-keyframes drop-129{100%{top:110%;left:39%}}@keyframes drop-129{100%{top:110%;left:39%}}.confetti-130{width:7px;height:2.8px;background-color:#ffbf00;top:-10%;left:55%;opacity:1.1256575658;transform:rotate(281.5583305761deg);-webkit-animation:drop-130 4.9137803435s .7516548493s infinite;animation:drop-130 4.9137803435s .7516548493s infinite}@-webkit-keyframes drop-130{100%{top:110%;left:68%}}@keyframes drop-130{100%{top:110%;left:68%}}.confetti-131{width:2px;height:.8px;background-color:#263672;top:-10%;left:65%;opacity:1.1809857939;transform:rotate(114.2703982163deg);-webkit-animation:drop-131 4.1369881462s 56.3814026ms infinite;animation:drop-131 4.1369881462s 56.3814026ms infinite}@-webkit-keyframes drop-131{100%{top:110%;left:75%}}@keyframes drop-131{100%{top:110%;left:75%}}.confetti-132{width:3px;height:1.2px;background-color:#263672;top:-10%;left:6%;opacity:1.3121692058;transform:rotate(.9728127029deg);-webkit-animation:drop-132 4.4069693868s .7576652362s infinite;animation:drop-132 4.4069693868s .7576652362s infinite}@-webkit-keyframes drop-132{100%{top:110%;left:7%}}@keyframes drop-132{100%{top:110%;left:7%}}.confetti-133{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:44%;opacity:.8086651159;transform:rotate(52.3943263657deg);-webkit-animation:drop-133 4.2681948165s 3.7873243ms infinite;animation:drop-133 4.2681948165s 3.7873243ms infinite}@-webkit-keyframes drop-133{100%{top:110%;left:52%}}@keyframes drop-133{100%{top:110%;left:52%}}.confetti-134{width:4px;height:1.6px;background-color:#ffbf00;top:-10%;left:88%;opacity:.9059270315;transform:rotate(47.7164049388deg);-webkit-animation:drop-134 4.7133352685s .6168228437s infinite;animation:drop-134 4.7133352685s .6168228437s infinite}@-webkit-keyframes drop-134{100%{top:110%;left:96%}}@keyframes drop-134{100%{top:110%;left:96%}}.confetti-135{width:6px;height:2.4px;background-color:#ffbf00;top:-10%;left:16%;opacity:.9085941679;transform:rotate(165.420563634deg);-webkit-animation:drop-135 4.8913856712s .8621003987s infinite;animation:drop-135 4.8913856712s .8621003987s infinite}@-webkit-keyframes drop-135{100%{top:110%;left:26%}}@keyframes drop-135{100%{top:110%;left:26%}}.confetti-136{width:3px;height:1.2px;background-color:#263672;top:-10%;left:4%;opacity:.9342222483;transform:rotate(151.6085810021deg);-webkit-animation:drop-136 4.538562006s .9277312827s infinite;animation:drop-136 4.538562006s .9277312827s infinite}@-webkit-keyframes drop-136{100%{top:110%;left:11%}}@keyframes drop-136{100%{top:110%;left:11%}}.confetti-137{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:95%;opacity:.7101440694;transform:rotate(28.1092993526deg);-webkit-animation:drop-137 4.3800775146s .1372552298s infinite;animation:drop-137 4.3800775146s .1372552298s infinite}@-webkit-keyframes drop-137{100%{top:110%;left:101%}}@keyframes drop-137{100%{top:110%;left:101%}}.confetti-138{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:74%;opacity:1.0290323379;transform:rotate(292.5753093507deg);-webkit-animation:drop-138 4.8067577602s .4233506261s infinite;animation:drop-138 4.8067577602s .4233506261s infinite}@-webkit-keyframes drop-138{100%{top:110%;left:83%}}@keyframes drop-138{100%{top:110%;left:83%}}.confetti-139{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:1%;opacity:1.0708153904;transform:rotate(25.0215209133deg);-webkit-animation:drop-139 4.7896855221s .8882241512s infinite;animation:drop-139 4.7896855221s .8882241512s infinite}@-webkit-keyframes drop-139{100%{top:110%;left:14%}}@keyframes drop-139{100%{top:110%;left:14%}}.confetti-140{width:4px;height:1.6px;background-color:#d13447;top:-10%;left:39%;opacity:1.1243740053;transform:rotate(197.1627557054deg);-webkit-animation:drop-140 4.4403331742s .8723665643s infinite;animation:drop-140 4.4403331742s .8723665643s infinite}@-webkit-keyframes drop-140{100%{top:110%;left:54%}}@keyframes drop-140{100%{top:110%;left:54%}}.confetti-141{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:87%;opacity:.9889313904;transform:rotate(209.9079037812deg);-webkit-animation:drop-141 4.9846251106s .177668484s infinite;animation:drop-141 4.9846251106s .177668484s infinite}@-webkit-keyframes drop-141{100%{top:110%;left:90%}}@keyframes drop-141{100%{top:110%;left:90%}}.confetti-142{width:8px;height:3.2px;background-color:#263672;top:-10%;left:46%;opacity:.9115863255;transform:rotate(297.1051768112deg);-webkit-animation:drop-142 4.33769249s .5711063254s infinite;animation:drop-142 4.33769249s .5711063254s infinite}@-webkit-keyframes drop-142{100%{top:110%;left:61%}}@keyframes drop-142{100%{top:110%;left:61%}}.confetti-143{width:6px;height:2.4px;background-color:#d13447;top:-10%;left:56%;opacity:1.2257625892;transform:rotate(244.4990607907deg);-webkit-animation:drop-143 4.399267369s .3688952427s infinite;animation:drop-143 4.399267369s .3688952427s infinite}@-webkit-keyframes drop-143{100%{top:110%;left:62%}}@keyframes drop-143{100%{top:110%;left:62%}}.confetti-144{width:6px;height:2.4px;background-color:#263672;top:-10%;left:14%;opacity:.5211602346;transform:rotate(333.1262926063deg);-webkit-animation:drop-144 4.9223305013s .3330983323s infinite;animation:drop-144 4.9223305013s .3330983323s infinite}@-webkit-keyframes drop-144{100%{top:110%;left:24%}}@keyframes drop-144{100%{top:110%;left:24%}}.confetti-145{width:6px;height:2.4px;background-color:#ffbf00;top:-10%;left:11%;opacity:1.0557604453;transform:rotate(7.1228744053deg);-webkit-animation:drop-145 4.8406581117s .2200784583s infinite;animation:drop-145 4.8406581117s .2200784583s infinite}@-webkit-keyframes drop-145{100%{top:110%;left:15%}}@keyframes drop-145{100%{top:110%;left:15%}}.confetti-146{width:4px;height:1.6px;background-color:#263672;top:-10%;left:100%;opacity:.8675086809;transform:rotate(109.5521784067deg);-webkit-animation:drop-146 4.6487804306s .8715883739s infinite;animation:drop-146 4.6487804306s .8715883739s infinite}@-webkit-keyframes drop-146{100%{top:110%;left:111%}}@keyframes drop-146{100%{top:110%;left:111%}}.confetti-147{width:8px;height:3.2px;background-color:#d13447;top:-10%;left:85%;opacity:.5840221189;transform:rotate(8.4675855615deg);-webkit-animation:drop-147 4.0336318142s .9472278342s infinite;animation:drop-147 4.0336318142s .9472278342s infinite}@-webkit-keyframes drop-147{100%{top:110%;left:96%}}@keyframes drop-147{100%{top:110%;left:96%}}.confetti-148{width:6px;height:2.4px;background-color:#263672;top:-10%;left:18%;opacity:.6097497424;transform:rotate(199.9279649891deg);-webkit-animation:drop-148 4.9347622979s .370103389s infinite;animation:drop-148 4.9347622979s .370103389s infinite}@-webkit-keyframes drop-148{100%{top:110%;left:20%}}@keyframes drop-148{100%{top:110%;left:20%}}.confetti-149{width:1px;height:.4px;background-color:#ffbf00;top:-10%;left:48%;opacity:.7121151359;transform:rotate(160.8101414997deg);-webkit-animation:drop-149 4.768707693s .6069180858s infinite;animation:drop-149 4.768707693s .6069180858s infinite}@-webkit-keyframes drop-149{100%{top:110%;left:51%}}@keyframes drop-149{100%{top:110%;left:51%}}.confetti-150{width:4px;height:1.6px;background-color:#263672;top:-10%;left:80%;opacity:1.3217241184;transform:rotate(71.1396630999deg);-webkit-animation:drop-150 4.6585685352s .4944116941s infinite;animation:drop-150 4.6585685352s .4944116941s infinite}@-webkit-keyframes drop-150{100%{top:110%;left:91%}}@keyframes drop-150{100%{top:110%;left:91%}}</style><div style="display:flex;flex-direction:column;align-content:center;flex-wrap:wrap;align-items:center;justify-content:center;height:100%;position:absolute;top:0;left:0;width:100%"><t1 style="color:#fff;font-family:monospace;font-size:xxx-large;font-weight:bolder">Congratulation!</t1><br><t2 style="color:#fff;font-family:monospace;font-size:xx-large;font-weight:bolder">You have successfully connected your twitter!</t2></div></body></html>""");
      request.response.close();

      switch (type) {
        case OAuthType.twitter:
          if (!request.uri.queryParameters.containsKey("code")) break;

          cred = OAuthCredentials.fromMap(await _twitterCodeToAccessToken(
              request.uri.queryParameters["code"]!));


          server.close();
          break;
      }


    });

    return cred;
  }

  /// Retrieve access token and refresh token from twitter server with
  /// the given code.
  ///
  /// Returns a map containing the refresh token {"accessToken":"", "refreshToken":""}
  static Future<Map<String, String>> _twitterCodeToAccessToken(
      String authCode) async {
    var headers = {
      'Content-Type': 'application/x-www-form-urlencoded',
    };

    log("Auth code: $authCode");

    var data = {
      'code': authCode,
      'grant_type': 'authorization_code',
      'client_id': twitterClientId,
      'redirect_uri': twitterCallback,
      'code_verifier': 'challenge',
    };

    var url = Uri.parse('https://api.twitter.com/2/oauth2/token');
    var res = await http.post(url, headers: headers, body: data);

    log(res.body);
    if (res.statusCode != 200) {
      throw Exception('http.post error: statusCode= ${res.statusCode}');
    }

    log("Twitter API V2 has returned the following results, it should not be shared to any third party.");
    log("--hidden--");

    return {
      "access_token": jsonDecode(res.body)["access_token"],
      "refresh_token": jsonDecode(res.body)["refresh_token"]
    };
  }

  static Future<OAuthCredentials> twitterRefreshAccessToken(
      String refreshToken) async {
    var headers = {
      'Content-Type': 'application/x-www-form-urlencoded',
    };

    var data = {
      'refresh_token': refreshToken,
      'grant_type': 'refresh_token',
      'client_id': twitterClientId,
    };

    log("Requesting new access token");

    var url = Uri.parse('https://api.twitter.com/2/oauth2/token');
    var res = await http.post(url, headers: headers, body: data);
    if (res.statusCode != 200) {
      throw Exception('http.post error: statusCode= ${res.statusCode}');
    }

    return OAuthCredentials(
        accessToken: jsonDecode(res.body)["access_token"],
        refreshToken: jsonDecode(res.body)["refresh_token"]);
  }
}
